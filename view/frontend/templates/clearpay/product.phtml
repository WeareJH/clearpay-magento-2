<?php
/**
 * Magento 2 extensions for Clearpay Payment
 *
 * @author Clearpay
 * @copyright 2021 Clearpay https://www.clearpay.com
 */
$product_type = $block->getTypeOfProduct();
$data_amount = $block->getFinalAmount();
if($block->isPaymentMethodActive()  && $block->isDisplayOnProductPage() && $product_type != "grouped" && $block->canUseCurrency() && $data_amount > 0){

    $clearpay_eligible = "true";
    if (($block->canShow() === false)) {
        $clearpay_eligible = "false";
    }
    $min_limit=$block->getMinOrderLimit();
    $show_lower_limit="true";
    if((float)$min_limit<1){
        $show_lower_limit="false";
    }
    ?>
    <script
    	src="<?= $block->escapeUrl($block->getClearpayJsLibUrl());?>"
    	data-min="<?= /* @noEscape */ $min_limit; ?>"
    	data-max="<?= /* @noEscape */ $block->getMaxOrderLimit(); ?>" async></script>
    <?php
    $store_currency = $block->getCurrentCurrency();
    $data_locale = $block->getCurrentLocale();
    
    ?>
    <afterpay-placement
    	data-locale="<?= /* @noEscape */  $data_locale;?>"
    	data-currency="<?= /* @noEscape */ $store_currency;?>"
		data-is-eligible="<?= /* @noEscape */ $clearpay_eligible;?>"
    	data-amount="<?= /* @noEscape */ $data_amount; ?>">
    </afterpay-placement>
<?php
}
?>
